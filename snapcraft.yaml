name: tuned-switcher
base: core22
adopt-info: tuned-switcher
grade: stable
confinement: strict
architectures:
  - build-on: amd64
  - build-on: arm64
  - build-on: ppc64el

apps:
  tuned-switcher:
    command: usr/bin/tuned-switcher
    common-id: org.easycoding.TunedSwitcher
    desktop: usr/share/applications/org.easycoding.TunedSwitcher.desktop
    extensions:
      - kde-neon
    plugs:
      - desktop
      - unity7
      - wayland
      - x11
      - tuned-dbus
      - systemd-dbus

parts:
  tuned-switcher:
    plugin: cmake
    source: https://github.com/EasyCoding/tuned-switcher.git
    source-type: git
    parse-info:
      - usr/share/metainfo/org.easycoding.TunedSwitcher.metainfo.xml
    build-packages:
      - g++
      - make
      - qtbase5-dev
      - qttools5-dev
      - qttools5-dev-tools
    stage-packages:
      - dbus
      - dbus-x11
      - libqt5core5a
      - libqt5dbus5
      - libqt5gui5
      - libqt5svg5
      - libqt5widgets5
      - libx11-6
      - libxcb1
      - libxkbcommon0
      - qtwayland5
    cmake-parameters:
      - -DCMAKE_BUILD_TYPE=RelWithDebInfo
      - -DCMAKE_INSTALL_PREFIX=/usr
    organize:
      usr/share/qt5/translations/*.qm: usr/share/tuned-switcher/translations/

plugs:
  tuned-dbus: # used to communicate with the TuneD service
    interface: dbus
    bus: system
    name: com.redhat.tuned

  systemd-dbus: # used to track the TuneD service status and to run/stop it
    interface: dbus
    bus: system
    name: org.freedesktop.systemd1
